/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var t=[(t,e,r)=>{r.r(e),r.d(e,{bind:()=>i.bind,cached:()=>i.cached,emptyObject:()=>i.emptyObject,extend:()=>i.extend,genStaticKeys:()=>i.genStaticKeys,getDataType:()=>i.getDataType,hasOwn:()=>i.hasOwn,hyphenate:()=>i.hyphenate,identity:()=>i.identity,isDef:()=>i.isDef,isObject:()=>i.isObject,isPlainObject:()=>i.isPlainObject,isPrimitive:()=>i.isPrimitive,isPromise:()=>i.isPromise,isRegExp:()=>i.isRegExp,isUndef:()=>i.isUndef,isValidArrayIndex:()=>i.isValidArrayIndex,looseEqual:()=>i.looseEqual,looseIndexOf:()=>i.looseIndexOf,makeMap:()=>i.makeMap,no:()=>i.no,noop:()=>i.noop,once:()=>i.once,remove:()=>i.remove,toArray:()=>i.toArray,toNumber:()=>i.toNumber,toObject:()=>i.toObject,toRawType:()=>i.toRawType,toString:()=>i.toString,typeJudger:()=>i.typeJudger,defineReactive:()=>o.defineReactive,def:()=>function(t,e,r,n){Object.defineProperty(t,e,{value:r,enumerable:!!n,writable:!0,configurable:!0})},isParentPath:()=>function(t,e,r){if(Array.isArray(e))return l(e,t);var n,i=e,o=a(t);try{for(o.s();!(n=o.n()).done;){var u=n.value;if("object"!==s(i)||!i)return!1;i=i[u]}}catch(t){o.e(t)}finally{o.f()}return r&&r(i),void 0!==i},isChildPath:()=>l,createTreeByPaths:()=>function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t.map((function(t){for(var r,n=e,i=0;i<t.length&&(r=t[i],null!==n);i++)n&&i===t.length-1?n[r]=null:void 0===n[r]?n=n[r]={}:n&&"object"==s(n)&&(n=n[r])})),e},getCertainPathChild:()=>function(t,e){t=n().fromJS(t);for(var r=e,i=0;i<t.size;i++){if("object"!=s(r)){r=void 0;break}r=r[t.get(i)]}return r},sliceChildTreePath:()=>function(t,e){if(!(t.length<e.length)){for(var r=0;r<e.length;r++)if(t[r]!==e[r])return;return t.slice(e.length)}}}),e=r(1);var n=r.n(e),i=r(3),o=r(5);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return{s:e=function(){},n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return o=t.done,t},e:function(t){s=!0,i=t},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw i}}}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){if(!Array.isArray(e))return function(t,e){var r,n=e,i=a(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if("object"!==s(n))return!1;if(null===n)break;if(void 0===(n=n[o]))return!1}}catch(t){i.e(t)}finally{i.f()}return"object"!==s(n)||!n}(t,e);if(t=n().fromJS(t),e=n().fromJS(e),t.size<e.size)return!1;for(var r=e.size-1;0<r;r--)if(e.get(r)!=t.get(r))return!1;return!0}},t=>{t.exports=require("immutable")},t=>{t.exports=require("tree-snap-shot")},(t,e,r)=>{function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}r.r(e),r.d(e,{emptyObject:()=>i,isUndef:()=>function(t){return null==t},isDef:()=>o,isPrimitive:()=>function(t){return"string"==typeof t||"number"==typeof t||"symbol"===n(t)||"boolean"==typeof t||null==t},getDataType:()=>function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return Immutable.isImmutable(t)&&!e?"Immutable "+t.toString().split(" ")[0]:(Immutable.isImmutable(t)&&e&&(t=t.toJS()),typeOf(t))},typeJudger:()=>function(t){return Object.prototype.toString.call(t)},isObject:()=>s,toRawType:()=>function(t){return a.call(t).slice(8,-1)},isPlainObject:()=>u,isRegExp:()=>function(t){return"[object RegExp]"===a.call(t)},isValidArrayIndex:()=>function(t){var e=parseFloat(String(t));return 0<=e&&Math.floor(e)===e&&isFinite(t)},isPromise:()=>function(t){return o(t)&&"function"==typeof t.then&&"function"==typeof t.catch},toString:()=>function(t){return null==t?"":Array.isArray(t)||u(t)&&t.toString===a?JSON.stringify(t,null,2):String(t)},toNumber:()=>function(t){var e=parseFloat(t);return isNaN(e)?t:e},makeMap:()=>function(t,e){for(var r=Object.create(null),n=t.split(","),i=0;i<n.length;i++)r[n[i]]=!0;return e?function(t){return r[t.toLowerCase()]}:function(t){return r[t]}},remove:()=>function(t,e){if(t.length&&-1<(e=t.indexOf(e)))return t.splice(e,1)},hasOwn:()=>function(t,e){return l.call(t,e)},cached:()=>c,hyphenate:()=>h,bind:()=>y,toArray:()=>function(t,e){e=e||0;for(var r=t.length-e,n=new Array(r);r--;)n[r]=t[r+e];return n},extend:()=>p,toObject:()=>function(t){for(var e={},r=0;r<t.length;r++)t[r]&&p(e,t[r]);return e},noop:()=>function(t,e,r){},no:()=>g,identity:()=>m,genStaticKeys:()=>function(t){return t.reduce((function(t,e){return t.concat(e.staticKeys||[])}),[]).join(",")},looseEqual:()=>b,looseIndexOf:()=>function(t,e){for(var r=0;r<t.length;r++)if(b(t[r],e))return r;return-1},once:()=>function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}});var i=Object.freeze({});function o(t){return null!=t}function s(t){return null!==t&&"object"===n(t)}var a=Object.prototype.toString;function u(t){return"[object Object]"===a.call(t)}var l=Object.prototype.hasOwnProperty;function c(t){var e=Object.create(null);return function(r){return e[r]||(e[r]=t(r))}}var f=/\B([A-Z])/g,h=c((function(t){return t.replace(f,"-$1").toLowerCase()})),y=Function.prototype.bind?function(t,e){return t.bind(e)}:function(t,e){function r(r){var n=arguments.length;return n?1<n?t.apply(e,arguments):t.call(e,r):t.call(e)}return r._length=t.length,r};function p(t,e){for(var r in e)t[r]=e[r];return t}var g=function(t,e,r){return!1},m=function(t){return t};function b(t,e){if(t===e)return!0;var r=s(t),n=s(e);if(!r||!n)return!r&&!n&&String(t)===String(e);try{var i=Array.isArray(t),o=Array.isArray(e);if(i&&o)return t.length===e.length&&t.every((function(t,r){return b(t,e[r])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(i||o)return!1;var a=Object.keys(t),u=Object.keys(e);return a.length===u.length&&a.every((function(r){return b(t[r],e[r])}))}catch(r){return!1}}},,(t,e,r)=>{r.r(e),r.d(e,{shouldObserve:()=>u,toggleObserving:()=>function(t){u=t},Observer:()=>l,observe:()=>c,defineReactive:()=>f,set:()=>function(t,e,r){if(Array.isArray(t)&&(0,o.isValidArrayIndex)(e))return t.length=Math.max(t.length,e),t.splice(e,1,r),r;if(e in t&&!(e in Object.prototype))return t[e]=r;var n=t.__ob__;return n?(f(n.value,e,r),n.dep.notify(),r):t[e]=r},del:()=>function(t,e){var r;Array.isArray(t)&&(0,o.isValidArrayIndex)(e)?t.splice(e,1):(r=t.__ob__,(0,o.hasOwn)(t,e)&&(delete t[e],r&&r.dep.notify()))}});var n=r(10),i=r(0),o=r(3);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var a=Object.getOwnPropertyNames(n.arrayMethods),u=!0,l=function(){function t(e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"value",void 0),s(this,"vmCount",void 0),this.value=e,(this.vmCount=0,i.def)(e,"__ob__",this),Array.isArray(e)?(i.hasProto?(r=n.arrayMethods,e.__proto__=r):function(t,e,r){for(var n=0,o=r.length;n<o;n++){var s=r[n];(0,i.def)(t,s,e[s])}}(e,n.arrayMethods,a),this.observeArray(e)):this.walk(e)}var e;return(e=[{key:"walk",value:function(t){for(var e=Object.keys(t),r=0;r<e.length;r++)f(t,e[r])}},{key:"observeArray",value:function(t){for(var e=0,r=t.length;e<r;e++)c(t[e])}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}();function c(t){var e;if((0,o.isObject)(t))return(0,o.hasOwn)(t,"__ob__")&&t.__ob__ instanceof l?e=t.__ob__:u&&(Array.isArray(t)||(0,o.isPlainObject)(t))&&Object.isExtensible(t)&&(e=new l(t)),e}function f(t,e,r,n,i){var o,s,a=Object.getOwnPropertyDescriptor(t,e);a&&!1===a.configurable||(o=a&&a.get,s=a&&a.set,o&&!s||2!==arguments.length||(r=t[e]),i||c(r),Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){return o?o.call(t):r},set:function(e){var a=o?o.call(t):r;e===a||e!=e&&a!=a||(n&&n(),o&&!s||(s?s.call(t,e):r=e,i||c(e),dep.notify()))}}))}},(t,e,r)=>{r.r(e),r.d(e,{default:()=>m}),e=r(2);var n=r.n(e),i=r(7),o=r(0),s=r(11);function a(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)),n}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t){if(t.length)return(0,o.createTreeByPaths)(t)}function p(t,e){var r=1<arguments.length&&void 0!==e?e:".";if("string"!=typeof r||""===r)throw new Error('invalid split flag : "'+r+'"');var n=[];return Array.isArray(t)?t.map((function(t){"string"==typeof t?n.push(t.split(r)):Array.isArray(t)&&n.push(t)})):"string"==typeof t&&n.push(t.split(r)),n}function g(t,e,r){var i=2<arguments.length&&void 0!==r?r:{};(r=Object.keys(t)).length&&r.forEach((function(r){function o(t){o.resetId==i.context.resetId&&n().step(["replace",r.split(i.splitFlag||"."),t],e)}o.resetId=i.context.resetId,"function"==typeof t[r]?t[r](o):Array.isArray(t[r])&&t[r].forEach((function(t){"function"==typeof t&&t(o)}))}))}(r=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{paths:[],splitFlag:".",logMaxNum:1e3,ignore:[],async:{}};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,"el",null),f(this,"backup",null),f(this,"logs",null),f(this,"listeners",void 0),f(this,"splitFlag","."),f(this,"recordPaths",[]),f(this,"ignorePaths",[]),f(this,"eventsListeners",{}),f(this,"logStrategy",0),f(this,"logMaxNum",1e3),f(this,"asyncUpdate",{}),f(this,"resetId",""),this.logMaxNum=Math.max(e.logMaxNum,1)||1e3,this.splitFlag=e.splitFlag||".",this.asyncUpdate=e.async||{},Object.keys(this.asyncUpdate),e.paths&&(this.recordPaths=p(e.paths,this.splitFlag)),e.ignore&&(this.ignorePaths=p(e.ignore,this.splitFlag)),this.listeners=new s.default}var e;return(e=[{key:"watch",value:function(t,e){return"string"==typeof t&&(this.eventsListeners[t]=t.split(this.splitFlag),this.listeners.add(this.eventsListeners[t],e)),this}},{key:"removeObserver",value:function(t,e){return"string"==typeof t&&this.eventsListeners[t]&&(this.listeners.remove(this.eventsListeners[t],e),delete this.eventsListeners[t]),this}},{key:"trigger",value:function(t){for(var e,r=arguments.length,n=new Array(1<r?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];Array.isArray(t)?(e=this.listeners).trigger.apply(e,[t].concat(n)):(e=this.listeners).trigger.apply(e,[this.eventsListeners[t]].concat(n))}},{key:"removeCommit",value:function(t){return this.logs.remove(t,(function(t){t&&t.clear&&t.clear()})),this}},{key:"commit",value:function(t){return this.el&&(n().deepEqual(this.backup,this.el)||(null!==(e=(r=this.backup).clear)&&void 0!==e&&e.call(r),this.backup=n().toImmutable(this.el)),this.logs.push(t,this.backup)),this;var e,r}},{key:"merge",value:function(t,e){return this}},{key:"log",value:function(t){return t&&this.logs.exportLogs(t),this}},{key:"diff",value:function(t,e,r){return"string"==typeof t&&(t=this.logs.search(t)),"string"==typeof e&&(e=this.logs.search(e)),r&&n().compare(t,e).getDiff(r),this}},{key:"revert",value:function(){}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}()).prototype.reset=function(t){var e=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{paths:[],splitFlag:".",ignore:[],async:{}};n().deepEqual(this.backup,this.el)||(null!==(m=(b=this.backup).clear)&&void 0!==m&&m.call(b),this.backup=n().toImmutable(this.el));var i,s,u,l=c(c({},this.asyncUpdate),r.async),f=this.logs.search(t),m=[].concat(a(p(r.paths,r.splitFlag||this.splitFlag)),a(this.recordPaths)),b=[].concat(a(p([].concat(a(Object.keys(l)),a(r.ignore||[])),r.splitFlag||this.splitFlag)),a(this.ignorePaths));return f&&(n().compare(this.backup,f,{maxDepth:20,listItemSimiliarity:.7}).exportLog((function(t){i=t})),s=y(m),u=y(b),n().replay(i,this.el,(function(t){if("init"==t[0]||"add"==t[0]||"update"==t[0]||"del"==t[0]){if(t[1]=n().union(t[1],s),t[1]=n().difference(t[1],u),"init"!=t[0])for(var r in e.eventsListeners)!function(r){(0,o.isParentPath)(e.eventsListeners[r],t[1],(function(n){void 0!==n&&e.trigger(e.eventsListeners[r],n,r,t[0])}))}(r)}else if("diff"==t[0]){if("object"==h(s)&&(!(0,o.isChildPath)(t[1],s)||(0,o.isChildPath)(t[1],u)))return!1}else if("replace"===t[0]&&"object"==h((0,o.getCertainPathChild)(t[1],e.el))){var i,a;for(a in e.eventsListeners)!function(r){(i=(0,o.sliceChildTreePath)(e.eventsListeners[r],t[1]))&&(0,o.isParentPath)(i,t[2],(function(n){void 0!==n&&e.trigger(e.eventsListeners[r],n,r,t[0])}))}(a)}})),this.resetId=t,g(l,this.el,{splitFlag:r.splitFlag||this.splitFlag,context:this})),this},r.prototype.pipe=function(t){if(t&&"object"!=h(t))throw new Error("只能绑定 typeof == “object” 普通对象或数组");return this.el=t,this.backup=n().toImmutable(t),this.logs=new i.default,this};const m=r},(t,e,r)=>{r.r(e),r.d(e,{default:()=>u});var n=r(9),i=(e=r(1),r.n(e));function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={"object-snap-shot":r(8).testLogs},a={setItem:function(t,e){s[t]=e},getItem:function(t){return s[t]}};(r=function t(){var e=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{store:a,storeName:"object-snap-shot",strategy:0};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"max",1e3),o(this,"storage",[]),o(this,"logs",[]),o(this,"keyIdx",{}),o(this,"size",0),o(this,"currentItem",null),o(this,"persistence",null),this.max=Math.max(r,1),this.persistence=new n.default({store:null==i?void 0:i.store,storeName:null!=i&&i.storeName?i.storeName:"object-snap-shot",strategy:null!==(i=i.strategy)&&void 0!==i?i:0}),this.storage=this.persistence.originalValueLogs,this.logs=this.persistence.logs,this.logs.forEach((function(t,r){e.keyIdx[t.commit]=r}))}).prototype.exportLogs=function(t){return t&&t(i().fromJS(this.persistence.logs).toJS()),this},r.prototype.init=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;this.persistence.clear(),this.keyIdx={},this.size=0,this.max=Math.max(t,1)},r.prototype.push=function(t,e){if(void 0!==this.keyIdx[t])return this.update(t,e);var r,n={key:t,value:e};return this.storage.length>this.max&&(r=this.storage[0],this.remove(r.key)),this.persistence.push(t,e),this.size=this.storage.length,this.keyIdx[t]=this.storage.length-1,this.currentItem=n},r.prototype.remove=function(t,e){if(void 0!==this.keyIdx[t]){var r,n=this.keyIdx[t],i=this.storage[n];for(r in this.persistence.remove(n),e&&e(i),delete this.keyIdx[t],this.keyIdx)this.keyIdx[r]>n&&this.keyIdx[r]--;return this.size=this.storage.length,this.currentItem===i&&(this.currentItem=this.storage[Math.min(n,this.size-1)]),i}},r.prototype.update=function(t,e){return void 0===this.keyIdx[t]?this.push(t,e):(t=this.keyIdx[t],this.persistence.update(t,e),t=this.storage[t],this.currentItem=t)},r.prototype.search=function(t){return console.log(),this.currentItem=this.storage[this.keyIdx[t]],this.currentItem};const u=r},(t,e,r)=>{r.r(e),r.d(e,{testLogs:()=>n});var n=[{commit:"commit 0",value:{id:0,list:[0],child:{name:"child0",info:{txt:"txt=0"}}},strategy:0},{commit:"commit 1",value:{id:1,list:[0,1],child:{name:"child1",info:{txt:"txt=1"}}},strategy:0},{commit:"commit 2",value:{id:2,list:[0,1,2],child:{name:"child2",info:{txt:"txt=2"}}},strategy:0},{commit:"commit 3",value:{id:3,list:[0,1,2,3],child:{name:"child3",info:{txt:"txt=3"}}},strategy:0},{commit:"commit 4",value:{id:4,list:[0,1,2,3,4],child:{name:"child4",info:{txt:"txt=4"}}},strategy:0},{commit:"commit 5",value:{id:5,list:[0,1,2,3,4,5],child:{name:"child5",info:{txt:"txt=5"}}},strategy:0},{commit:"commit 6",value:{id:6,list:[0,1,2,3,4,5,6],child:{name:"child6",info:{txt:"txt=6"}}},strategy:0},{commit:"commit 7",value:{id:7,list:[0,1,2,3,4,5,6,7],child:{name:"child7",info:{txt:"txt=7"}}},strategy:0},{commit:"commit 8",value:{id:8,list:[0,1,2,3,4,5,6,7,8],child:{name:"child8",info:{txt:"txt=8"}}},strategy:0},{commit:"commit 9",value:{id:9,list:[0,1,2,3,4,5,6,7,8,9],child:{name:"child9",info:{txt:"txt=9"}}},strategy:0},{commit:"clear child",value:{id:9,list:[0,1,2,3,4,5,6,7,8,9],child:[]},strategy:0},{commit:"clear all",value:{},strategy:0}]},(t,e,r)=>{r.r(e),r.d(e,{default:()=>g}),e=r(1);var n=r.n(e),i=(e=r(2),r.n(e));function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)),n}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,r){return e&&f(t.prototype,e),r&&f(t,r),t}function y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var p=function(){function t(e){c(this,t),y(this,"storeName","object-snap-shot"),y(this,"persistor",null),y(this,"originalValueLogs",[]),y(this,"logs",[]),y(this,"strategy",1),this.setOption(e)}return h(t,[{key:"init",value:function(t){var e=this;return this.logs.length=0,this.originalValueLogs.length=0,t.forEach((function(t,r){0==t.strategy?(t.value=n().fromJS(t.value),e.originalValueLogs.push(t.value),e.logs.push(t)):(t.value=t.value.map((function(t){return n().fromJS(t)})),e.logs.push(t),r=1==t.strategy?e.originalValueLogs[r-1]:e.originalValueLogs[0],r=(n().isImmutable(r)?r:n().fromJS(r)).toJS(),i().replay(t.value,r),e.originalValueLogs.push(n().fromJS(r)))})),console.log(n().fromJS(this.logs).toJS(),"<<<<<<<<<<<< persistor"),this}},{key:"setOption",value:function(t){"string"==typeof t.storeName&&(this.storeName=t.storeName||"object-snap-shot"),console.log(t,"<<<<<<<<<<<< option"),t.store&&this.setPersistor(t.store),"number"!=typeof t.strategy&&"string"!=typeof t.strategy||(this.strategy=t.strategy)}},{key:"setPersistor",value:function(t){if("function"!=typeof t.setItem||"function"!=typeof t.getItem)throw new Error("Persistence needs function setItem and getItem");if(this.persistor=t,"string"==typeof(t=this.persistor.getItem(this.storeName)||[]))try{t=JSON.parse(t)}catch(t){this.logs.length=0}Array.isArray(t)&&this.init(t)}}]),t}(),g=function(){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,p);var t=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=l(t);return r=e?(r=l(this).constructor,Reflect.construct(n,arguments,r)):n.apply(this,arguments),n=this,!(r=r)||"object"!==o(r)&&"function"!=typeof r?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(n):r}}(e);function e(){return c(this,e),t.apply(this,arguments)}return h(e,[{key:"transform",value:function(t,e){var r,o=this;0==(t=n().isImmutable(t)?t.toJS():t).strategy?this.logs.push(t):(r=1==t.strategy?this.originalValueLogs[e-1]:this.originalValueLogs[0],i().compare(r,t.value).getDiff((function(r){t.value=r,o.logs[e]=t}))),this.persistor&&this.persistor.setItem(this.name,this.logs.map((function(t){return n().isImmutable(t.value)?a(a({},t),{},{value:t.value.toJS()}):t})))}},{key:"push",value:function(t,e,r){r={commit:t,value:e,strategy:r||this.strategy},this.originalValueLogs.push(e),this.logs.length||(r.strategy=0),this.transform(r,this.originalValueLogs.length-1)}},{key:"remove",value:function(t){this.originalValueLogs.splice(t,1),this.logs.splice(t,1),this.logs[t]&&1==this.logs[t].strategy&&this.transform(this.logs[t],t)}},{key:"update",value:function(t,e){this.logs[t].value=e,1==this.logs[t].strategy&&this.transform(this.logs[t],t)}},{key:"clear",value:function(){this.logs.length=0,this.originalValueLogs.length=0,this.persistor&&this.persistor.setItem(this.name,[])}}]),e}()},(t,e,r)=>{r.r(e),r.d(e,{arrayMethods:()=>o});var n=r(0),i=Array.prototype,o=Object.create(i);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(t){var e=i[t];(0,n.def)(o,t,(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o,s=e.apply(this,n),a=this.__ob__;switch(t){case"push":case"unshift":o=n;break;case"splice":o=n.slice(2)}return o&&a.observeArray(o),a.dep.notify(),s}))}))},(t,e,r)=>{r.r(e),r.d(e,{default:()=>c});var n=r(0);function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e=r.g.Symbol;var a=0;e||((e=function(t){return"__".concat(t,"_").concat(Math.floor(1e9*Math.random()),"_").concat(++a,"__")}).iterator=e("Symbol.iterator")),r.g.Symbol=e;var u="flag";function l(t,e,r){e=(0,n.getCertainPathChild)(t,e);var o=[];return function t(e){if("object"===s(e))for(var n in e[u]&&(r?e[u]=e[u].filter((function(t){return t!==r})):o.push.apply(o,i(e[u]))),e)"object"==s(e[n])&&(n===u?e[n][u]&&(r?e[n][u]=e[n][u].filter((function(t){return t!==r})):o.push.apply(o,i(e[n][u]))):t(e[n]))}(e),o}var c=function(){function t(){var e,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r={},(e="cacheListener")in this?Object.defineProperty(this,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[e]=r}var e;return(e=[{key:"add",value:function(t,e){if(!Array.isArray(t))throw new Error("need array");return"function"==typeof e&&function(t,e,r){r=2<arguments.length?r:void 0;for(var n,i=e=1<arguments.length&&void 0!==e?e:{},o=0;o<t.length;o++)void 0===i[n=t[o]]?i=i[n]={}:i&&"object"==s(i)&&(i=i[n]);i[u]=i[u]||[],i[u].push(r)}(t,this.cacheListener,e),this}},{key:"remove",value:function(t,e){return l(t,this.cacheListener,e),this}},{key:"trigger",value:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return l(t,this.cacheListener).forEach((function(t){t.apply(void 0,r)})),this}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t.prototype,e),t}()}],e={};function r(n){var i=e[n];return void 0!==i||(i=e[n]={exports:{}},t[n](i,i.exports,r)),i.exports}r.amdO={},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{r.r(n);var t,e,i=r(6);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t=void 0,e=function(t){var e=i.default;t.default=e},"object"===("undefined"==typeof exports?"undefined":o(exports))?e(exports):"function"==typeof define&&r.amdO?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).DataTimeLine={})})()})();